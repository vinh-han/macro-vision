definitions:
  auth.LoginParam:
    properties:
      password:
        example: "11111"
        type: string
      username:
        example: ranto
        type: string
    type: object
  auth.LoginResponse:
    properties:
      token:
        example: f3d1b8cd4f29e6a173c0dd9d84b3af2d2e19a74ccf8b0e57a3c4d90e8f12b7ac
        type: string
    type: object
  auth.SignupParam:
    properties:
      display_name:
        example: phantom
        type: string
      email:
        example: ranto@example.com
        type: string
      password:
        example: "1233445"
        type: string
      username:
        example: ranto
        type: string
    type: object
  auth.SignupResponse:
    properties:
      token:
        example: f3d1b8cd4f29e6a173c0dd9d84b3af2d2e19a74ccf8b0e57a3c4d90e8f12b7ac
        type: string
    type: object
  database.Dish:
    properties:
      alt_name:
        $ref: '#/definitions/sql.NullString'
      course:
        type: string
      date_created:
        type: string
      description:
        type: string
      dish_id:
        type: string
      dish_name:
        type: string
      full_recipe:
        type: string
      source:
        type: string
    type: object
  database.Ingredient:
    properties:
      date_created:
        type: string
      ingredient_id:
        type: string
      ingredient_name:
        type: string
    type: object
  database.MealCard:
    properties:
      card_id:
        type: string
      date_created:
        type: string
      meal_date:
        type: string
      title:
        type: string
      user_id:
        type: string
    type: object
  echo.HTTPError:
    properties:
      message: {}
    type: object
  handlers.EditUserResponse:
    properties:
      display_name:
        example: phantom_1234
        type: string
      email:
        example: ranto@example.com
        type: string
    type: object
  handlers.Favorites:
    properties:
      dish_id:
        type: string
      dish_name:
        type: string
    type: object
  handlers.GetUserResponse:
    properties:
      display_name:
        example: phantom_1234
        type: string
      email:
        example: ranto@example.com
        type: string
      username:
        example: ranto
        type: string
    type: object
  handlers.RemoveFavoriteResponse:
    properties:
      dish_id:
        example: 123e4567-e89b-12d3-a456-426614174000
        type: string
    type: object
  handlers.SearchDishesResponse:
    properties:
      dishes:
        items:
          $ref: '#/definitions/database.Dish'
        type: array
      limit:
        type: integer
      page:
        type: integer
      total_pages:
        type: integer
      total_results:
        type: integer
    type: object
  mealcards.AddDishToCardParam:
    properties:
      card_id:
        type: string
      dish_id:
        type: string
    type: object
  mealcards.CreateMealCardParam:
    properties:
      dishes:
        items:
          type: string
        type: array
      meal_date:
        type: string
      title:
        type: string
    type: object
  mealcards.MealCardDish:
    properties:
      dishes:
        items:
          $ref: '#/definitions/database.Dish'
        type: array
      mealCard:
        $ref: '#/definitions/database.MealCard'
    type: object
  mealcards.RemoveDishFromCardParam:
    properties:
      card_id:
        type: string
      dish_id:
        type: string
    type: object
  mealcards.UpdateMealCardParam:
    properties:
      meal_date:
        type: string
      title:
        type: string
    type: object
  sql.NullString:
    properties:
      string:
        type: string
      valid:
        description: Valid is true if String is not NULL
        type: boolean
    type: object
  users.ChangePasswordParam:
    properties:
      current_password:
        type: string
      new_password:
        type: string
    type: object
  users.EditUserParam:
    properties:
      display_name:
        example: phantom_1234
        type: string
      email:
        example: ranto@example.com
        type: string
    type: object
info:
  contact: {}
  description: API for Macro_vision
  title: Macro_vision backend
  version: "1.0"
paths:
  /auth/login:
    post:
      consumes:
      - application/json
      description: Verify user’s login credentials (username and password), then generate
        a session and return the session token back to user
      parameters:
      - description: login parameters
        in: body
        name: Request
        required: true
        schema:
          $ref: '#/definitions/auth.LoginParam'
      produces:
      - application/json
      responses:
        "200":
          description: Ok
          schema:
            $ref: '#/definitions/auth.LoginResponse'
        "404":
          description: User not found in db
          schema:
            type: string
        "409":
          description: Invalid Credentials
          schema:
            type: string
        "500":
          description: Server Error
          schema:
            type: string
      summary: login
      tags:
      - auth
  /auth/logout:
    get:
      consumes:
      - application/json
      description: Verify the received token and perform session clean up.
      parameters:
      - description: 256bit random token
        example: f3d9c4e6a7b1ce204fa8d5b39e181f9b3e2c1d7fbe4490d6732eab5c4fd7c92e
        in: header
        name: Token
        required: true
        type: string
      produces:
      - application/json
      responses:
        "204":
          description: No Content
      summary: logout
      tags:
      - auth
  /auth/signup:
    post:
      consumes:
      - application/json
      description: Receive the sign up information, validate username (check if it
        exists), password (has to be lower than 71 byte for bcrypt hashing), and email
        (correct format). Then generate the session and return the token to the user
        (auto login)
      parameters:
      - description: signup parameters
        in: body
        name: Request
        required: true
        schema:
          $ref: '#/definitions/auth.SignupParam'
      produces:
      - application/json
      responses:
        "201":
          description: Account Created
          schema:
            $ref: '#/definitions/auth.SignupResponse'
        "409":
          description: Password too long (over 71 bytes)
          schema:
            type: string
        "500":
          description: Server Error
          schema:
            type: string
      summary: signup
      tags:
      - auth
  /dishes/{dish_id}:
    get:
      consumes:
      - application/json
      description: Retrieve a single dish by its UUID. If the dish does not exist,
        an empty object is returned.
      parameters:
      - description: Dish UUID
        in: path
        name: dish_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Dish details
          schema:
            $ref: '#/definitions/database.Dish'
        "400":
          description: Invalid dish ID
          schema:
            type: string
        "500":
          description: Server error
          schema:
            type: string
      summary: Get dish details
      tags:
      - dishes
  /dishes/search:
    get:
      consumes:
      - application/json
      description: Search dishes by name, course list, and ingredient count range.
        Results are paginated and include total match count.
      parameters:
      - description: Search query for dish name
        in: query
        name: q
        type: string
      - collectionFormat: csv
        description: Filter by course (can be repeated)
        in: query
        items:
          type: string
        name: course
        type: array
      - description: Minimum number of ingredients
        in: query
        name: min_ingredients
        type: integer
      - description: Maximum number of ingredients
        in: query
        name: max_ingredients
        type: integer
      - description: 'Number of results per page (default: 12)'
        in: query
        name: limit
        type: integer
      - description: Page number (1-based)
        in: query
        name: page
        type: integer
      produces:
      - application/json
      responses:
        "200":
          description: Search results
          schema:
            $ref: '#/definitions/handlers.SearchDishesResponse'
        "400":
          description: Invalid query parameters
          schema:
            type: string
        "500":
          description: Server error
          schema:
            type: string
      summary: Search dishes with filters and pagination
      tags:
      - dishes
  /ingredients:
    get:
      description: Retrieve the full list of ingredients from the database
      produces:
      - application/json
      responses:
        "200":
          description: List of ingredients
          schema:
            items:
              $ref: '#/definitions/database.Ingredient'
            type: array
        "500":
          description: Server error
          schema:
            type: string
      summary: Get all ingredients
      tags:
      - ingredients
  /ingredients/{ingredient_id}:
    get:
      description: Retrieve a single ingredient by its ID
      parameters:
      - description: Ingredient ID
        in: path
        name: ingredient_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Ingredient
          schema:
            $ref: '#/definitions/database.Ingredient'
        "500":
          description: Server error
          schema:
            type: string
      summary: Get ingredient
      tags:
      - ingredients
  /ingredients/search:
    get:
      description: Search ingredients by a query string
      parameters:
      - description: Search query
        in: query
        name: q
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: List of matching ingredients
          schema:
            items:
              $ref: '#/definitions/database.Ingredient'
            type: array
        "500":
          description: Server error
          schema:
            type: string
      summary: Search ingredients
      tags:
      - ingredients
  /meal-cards:
    delete:
      consumes:
      - application/json
      description: Remove a meal card belonging to the authenticated user.
      parameters:
      - description: Meal card ID (UUID)
        in: query
        name: card_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            type: string
        "400":
          description: Invalid request or unauthorized operation
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "404":
          description: Meal card not found
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/echo.HTTPError'
      security:
      - BasicAuth: []
      summary: Remove meal card
      tags:
      - meal-cards
    get:
      consumes:
      - application/json
      description: Retrieve a meal card and its dishes belonging to the authenticated
        user.
      parameters:
      - description: Meal card ID (UUID)
        in: query
        name: card_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/mealcards.MealCardDish'
        "400":
          description: Invalid request parameters
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "404":
          description: Meal card not found
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/echo.HTTPError'
      security:
      - BasicAuth: []
      summary: Get meal card with dishes
      tags:
      - meal-cards
    post:
      consumes:
      - application/json
      description: Create a new meal card for the authenticated user.
      parameters:
      - description: Meal card payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/mealcards.CreateMealCardParam'
      produces:
      - application/json
      responses:
        "201":
          description: new card uuid
          schema:
            type: string
        "400":
          description: Invalid request body
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/echo.HTTPError'
      security:
      - BasicAuth: []
      summary: Create meal card
      tags:
      - meal-cards
    put:
      consumes:
      - application/json
      description: Update meal card information belonging to the authenticated user.
      parameters:
      - description: Updated meal card payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/mealcards.UpdateMealCardParam'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/mealcards.MealCardDish'
        "400":
          description: Invalid request body
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "404":
          description: Meal card not found
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/echo.HTTPError'
      security:
      - BasicAuth: []
      summary: Update meal card
      tags:
      - meal-cards
  /meal-cards/daily:
    get:
      consumes:
      - application/json
      description: Retrieve all meal cards for a specific day belonging to the authenticated
        user.
      parameters:
      - description: Meal date (YYYY-MM-DD)
        in: query
        name: date
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/database.MealCard'
            type: array
        "400":
          description: Invalid request parameters
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "404":
          description: No meal cards found
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/echo.HTTPError'
      security:
      - BasicAuth: []
      summary: Get daily meal cards
      tags:
      - meal-cards
  /meal-cards/dishes:
    delete:
      consumes:
      - application/json
      description: Remove a dish from a meal card belonging to the authenticated user.
      parameters:
      - description: Remove dish from meal card payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/mealcards.RemoveDishFromCardParam'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            type: string
        "400":
          description: Invalid request or unauthorized operation
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "404":
          description: Meal card or dish not found
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/echo.HTTPError'
      security:
      - BasicAuth: []
      summary: Remove dish from meal card
      tags:
      - meal-cards
    post:
      consumes:
      - application/json
      description: Add a dish to a meal card belonging to the authenticated user.
      parameters:
      - description: Add dish to meal card payload
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/mealcards.AddDishToCardParam'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            type: string
        "400":
          description: Invalid request or unauthorized operation
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "404":
          description: Meal card or dish not found
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/echo.HTTPError'
      security:
      - BasicAuth: []
      summary: Add dish to meal card
      tags:
      - meal-cards
  /meal-cards/monthly:
    get:
      consumes:
      - application/json
      description: Retrieve all meal cards for the month of the given date belonging
        to the authenticated user. The day portion of the date is ignored.
      parameters:
      - description: Reference date (YYYY-MM-DD); day is ignored
        in: query
        name: date
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/database.MealCard'
            type: array
        "400":
          description: Invalid request parameters
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "404":
          description: No meal cards found
          schema:
            $ref: '#/definitions/echo.HTTPError'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/echo.HTTPError'
      security:
      - BasicAuth: []
      summary: Get monthly meal cards
      tags:
      - meal-cards
  /users/favorites:
    get:
      consumes:
      - application/json
      description: Get the user id from the received session token, then query and
        return the list of user’s favorite dishes.
      parameters:
      - description: 256bit random token
        in: header
        name: Token
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Ok
          schema:
            items:
              $ref: '#/definitions/handlers.Favorites'
            type: array
        "401":
          description: no auth token found
          schema:
            type: string
        "403":
          description: Invalid token
          schema:
            type: string
        "500":
          description: Server Error
          schema:
            type: string
      summary: get_info
      tags:
      - users
  /users/favorites/{dish_id}:
    delete:
      consumes:
      - application/json
      description: |-
        Extract the user session from the provided token, validate the dish ID (UUIDv4),
        then remove the dish from the user’s favorites list.
      parameters:
      - description: 256-bit random session token
        in: header
        name: Token
        required: true
        type: string
      - description: UUIDv4 dish identifier
        in: path
        name: dish_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: removed dish id
          schema:
            $ref: '#/definitions/handlers.RemoveFavoriteResponse'
        "400":
          description: Invalid id
          schema:
            type: string
        "401":
          description: no auth token found
          schema:
            type: string
        "403":
          description: Invalid token
          schema:
            type: string
        "500":
          description: Server Error
          schema:
            type: string
      summary: remove_favorite
      tags:
      - users
    patch:
      consumes:
      - application/json
      description: |-
        Extract the user session from the provided token, validate the dish ID (UUIDv4),
        then insert the dish into the user’s favorites list.
      parameters:
      - description: 256-bit random session token
        in: header
        name: Token
        required: true
        type: string
      - description: UUIDv4 dish identifier
        in: path
        name: dish_id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "201":
          description: Added to favorites
          schema:
            type: string
        "400":
          description: Invalid id
          schema:
            type: string
        "401":
          description: no auth token found
          schema:
            type: string
        "403":
          description: Invalid token
          schema:
            type: string
        "500":
          description: Server Error
          schema:
            type: string
      summary: add_favorite
      tags:
      - users
  /users/information:
    get:
      consumes:
      - application/json
      description: Get the user id from the received session token, then query and
        return with the corresponding user’s information (except password)
      parameters:
      - description: 256bit random token
        example: f3d9c4e6a7b1ce204fa8d5b39e181f9b3e2c1d7fbe4490d6732eab5c4fd7c92e
        in: header
        name: Token
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: Ok
          schema:
            $ref: '#/definitions/handlers.GetUserResponse'
        "401":
          description: no auth token found
          schema:
            type: string
        "403":
          description: Invalid token
          schema:
            type: string
        "500":
          description: Server Error
          schema:
            type: string
      summary: get_info
      tags:
      - users
    patch:
      consumes:
      - application/json
      description: Get the user id from the received session token, then query and
        return with the corresponding user’s information (except password)
      parameters:
      - description: 256bit random token
        in: header
        name: Token
        required: true
        type: string
      - description: new info
        in: body
        name: Input
        required: true
        schema:
          $ref: '#/definitions/users.EditUserParam'
      produces:
      - application/json
      responses:
        "200":
          description: Ok
          schema:
            $ref: '#/definitions/handlers.EditUserResponse'
        "400":
          description: Invalid input
          schema:
            type: string
        "401":
          description: no auth token found
          schema:
            type: string
        "403":
          description: Invalid token
          schema:
            type: string
        "500":
          description: Server Error
          schema:
            type: string
      summary: edit_info
      tags:
      - users
  /users/password:
    patch:
      consumes:
      - application/json
      description: |-
        Extracts the user session from the provided token, validates the request body,
        then updates the user's password.
      parameters:
      - description: 256-bit random session token
        in: header
        name: Token
        required: true
        type: string
      - description: New password payload
        in: body
        name: body
        required: true
        schema:
          $ref: '#/definitions/users.ChangePasswordParam'
      produces:
      - application/json
      responses:
        "204":
          description: No Content
        "400":
          description: Invalid Body
          schema:
            type: string
        "401":
          description: No auth token found
          schema:
            type: string
        "403":
          description: Invalid token
          schema:
            type: string
        "500":
          description: Server Error
          schema:
            type: string
      summary: change_password
      tags:
      - users
swagger: "2.0"
